FRT-Net: 面向航空ATRU的智能故障诊断系统
本项目实现了一个名为 FRT-Net (Fault Diagnosis Residual Transformer Network) 的先进深度学习模型，专为解决航空运输整流单元（ATRU） 的智能故障诊断问题而设计。ATRU作为飞机的关键二次电源，其稳定性直接关系到飞行安全。本项目旨在通过先进的人工智能技术，实现对ATRU多种故障模式的快速、精准识别。

该模型的核心思想是系统性地应对航空电子信号的四大挑战：强背景噪声、故障特征的多尺度特性、长程依赖关系以及极端的数据不平衡。

✨ 核心特性
航空电子领域专用: 模型专为航空ATRU的电子信号特性设计，聚焦于提升飞行安全与预测性维护能力。

频域先验引导: 通过快速傅里叶变换（FFT）将信号转换至频域，有效抑制时域中的强随机噪声，增强周期性故障谐波的可辨识度。

多尺度特征融合 (MCFFM): 并行使用多种不同尺寸的卷积核，使网络能够同时捕捉窄带谐波、宽带噪声等不同尺度上的故障信息，增强模型对多变工况的适应性。

CNN-Transformer混合架构: 融合了深度可分离残差网络（DSRB）强大的局部特征提取能力和轻量化Transformer对全局上下文的建模能力，实现了对故障模式的全面理解。

双头监督机制: 采用主、辅两个分类头对网络进行多层次监督，有效缓解了因故障数据稀缺和类别不平衡导致的过拟合问题，提升了对少数关键故障的识别敏感性。

高度模块化与可配置: 所有参数均通过 config/config.yaml 文件统一管理，代码结构清晰，易于维护、复现和扩展。

📂 项目结构
fault_diagnosis_project/
│
├── config/
│   └── config.yaml             # 所有参数的YAML配置文件
│
├── data/
│   ├── data_loader.py          # 数据集类和数据加载器
│   └── preprocessing.py        # 数据预处理函数
│
├── models/
│   ├── FRT_Net.py              # FRT-Net主模型架构
│   └── components/             # 模型的各个组件模块
│
├── training/
│   ├── trainer.py              # 训练器类
│   └── loss_functions.py       # 自定义损失函数
│
├── evaluation/
│   ├── tester.py               # 测试器类
│   └── metrics_calculator.py   # 评估指标计算
│
├── visualization/
│   └── confusion_matrix.py     # 绘制混淆矩阵
│
├── utils/
│   ├── config_loader.py        # 配置加载器
│   ├── logger.py               # 日志记录器
│   └── metrics.py              # 辅助指标计算
│
├── scripts/
│   ├── train.py                # 执行训练的脚本
│   └── test.py                 # 执行测试的脚本
│
├── outputs/                    # 默认输出目录 (自动创建)
│
├── requirements.txt            # 项目依赖库
└── README.md                   # 本文档

🚀 快速开始
1. 环境设置
首先，克隆本项目并安装所需的依赖库。

# 克隆仓库
git clone <your-repository-url>
cd fault_diagnosis_project

# 安装依赖
pip install -r requirements.txt

2. 参数配置
打开 config/config.yaml 文件，根据您的环境和需求修改以下关键参数：

paths.data_root: 必须修改为您存放ATRU数据集的根目录。

data.noise_level: 设置您希望使用的噪声等级目录名（例如 "no_db"）。

training.epochs: 设置训练的周期数。

3. 训练模型
配置完成后，运行训练脚本。脚本将自动加载数据，创建并训练FRT-Net模型。训练过程中，在验证集上表现最佳的模型将被保存在 outputs/models/ 目录下。

python scripts/train.py

4. 测试模型
训练完成后，运行测试脚本。脚本将加载性能最佳的模型，在测试集上进行最终评估，并生成详细的评估报告和混淆矩阵。

python scripts/test.py

📊 结果与输出
所有脚本的输出都会保存在 outputs/ 目录下，方便您追踪和分析实验结果：

模型: 训练过程中验证集上准确率最高的模型权重保存在 outputs/models/ 中。

日志: 训练和测试的详细过程记录在 outputs/logs/ 的 .log 文件中。

图表: 评估后生成的混淆矩阵图片保存在 outputs/figures/ 中。

报告: 详细的分类报告（包含每个类别的精确率、召回率、F1分数）以 .csv 格式保存在 outputs/results/ 中。